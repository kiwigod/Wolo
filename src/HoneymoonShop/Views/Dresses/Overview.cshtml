@{
    ViewData["Title"] = "Dress Overview";
    ViewData["Background"] = "white";
    ViewData["HeaderHeight"] = "6em";
}

@section Imports{
    <link rel="stylesheet" href="~/css/jquery-ui.min.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="~/css/overview.css" />
    <script>
        $(function () {
            $("#slider-range").slider({
                range: true,
                min: 0,
                max: 15000,
                values: [0, 15000],
                slide: function (event, ui) {
                    $("#amount").val("$" + ui.values[0] + " - $" + ui.values[1]);
                    $("#pricemin").val(ui.values[0]);
                    $("#pricemax").val(ui.values[1]);
                }
            });
            $("#amount").val('\u20AC' + $("#slider-range").slider("values", 0) +
              " - " + '\u20AC' + $("#slider-range").slider("values", 1));
        });

        $("#container").ready(function () {
            $("#overview").load(window.location + "&request=1");
        });

        var amntq = "&amnt=24";
        var sortq = "&sort=hl";
        var manuq = "&manu=all";
        var styleq = "&style=all";
        var neckq = "&neckline=all";
        var silq = "&silhouette=all";
        var colorq = "&color=all";

        $(document).ready(function () {
            $("#manu input").click(function () {
                var children = $("#manu input");
                manuq = "";
                for (var i = 0; i < children.length; i++) {
                    if (children.get(i).checked) {
                        manuq += "&manu=" + children.get(i).value;
                    }
                } if (manuq == "") manuq = "&manu=all";
                var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
                $("#overview").load(route + "&request=1");
                doPush(route);
            });
            $("#style input").click(function () {
                var children = $("#style input");
                styleq = "";
                for (var i = 0; i < children.length; i++) {
                    if (children.get(i).checked) {
                        styleq += "&style=" + children.get(i).value;
                    }
                } if (styleq == "") styleq = "&style=all";
                var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
                $("#overview").load(route + "&request=1");
                doPush(route);
            });
            $("#neck input").click(function () {
                var children = $("#neck input");
                neckq = "";
                for (var i = 0; i < children.length; i++) {
                    if (children.get(i).checked) {
                        neckq += "&neckline=" + children.get(i).value;
                    }
                } if (neckq == "") neckq = "&neckline=all";
                var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
                $("#overview").load(route + "&request=1");
                doPush(route);
            });
            $("#sil input").click(function () {
                var children = $("#sil input");
                silq = "";
                for (var i = 0; i < children.length; i++) {
                    if (children.get(i).checked) {
                        silq += "&silhouette=" + children.get(i).value;
                    }
                } if (silq == "") silq = "&silhouette=all";
                var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
                $("#overview").load(route + "&request=1");
                doPush(route);
            });
            $("#color input").click(function () {
                var children = $("#color input");
                colorq = "";
                for (var i = 0; i < children.length; i++) {
                    if (children.get(i).checked) {
                        colorq += "&color=" + children.get(i).value;
                    }
                } if (colorq == "") colorq = "&color=all";
                var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
                $("#overview").load(route + "&request=1");
                doPush(route);
            });
        });

        function searchPrice() {
            console.log($("#pricemax").val());
            console.log($("#pricemin").val());
            var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
            doPush(route);
            window.location.replace(route);
        }

        function sorting() {
            var e = document.getElementById("sort");
            sortq = "&sort=" + e.options[e.selectedIndex].value;
            var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
            $("#overview").load(route + "&request=1");
            doPush(route);
        }

        function amnt() {
            var e = document.getElementById("amnt");
            amntq = "&amnt=" + e.options[e.selectedIndex].value;
            var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=1";
            doPush(route);
            window.location.replace(route);
        }

        function goto(page) {
            if (page < 1) page = 1;
            var route = "OverviewFiltered?pricemin=" + $("#pricemin").val() + "&pricemax=" + $("#pricemax").val() + manuq + styleq + neckq + silq + colorq + sortq + amntq + "&page=" + page;
            doPush(route);
            window.location.replace(route);
        }

        function doPush(route) {
            var state = {},
                title = "Dress Overview",
                path = route;
            history.pushState(state, title, path);
        }
    </script>
    <script>
        function flipArrow(id) {
            var e = document.getElementById(id);
            var trans = e.style.transform;
            if (trans == "rotate(0deg)") {
                e.style.transform = "rotate(180deg)";
            }
            else {
                e.style.transform = "rotate(0deg)";
            }
        }

        function changeColor(elmnt) {
            var bcol = elmnt.style.background;
            if (bcol == "rgb(246, 246, 246)") {
                elmnt.style.background = "white";
            }
            else {
                elmnt.style.background = "rgb(246, 246, 246)";
            }
        }
    </script>
}

<div class="container" style="background:white">
    <hr />
    <div class="row">
        <div class="col-md-12">
            <ol class="breadcrumb">
                <li><a asp-action="Index" asp-controller="Home" style="color:#f47590">Home</a></li>
                <li><a asp-action="Index" asp-controller="Dresses" style="color:#f47590">Bruid</a></li>
                <li class="active">Dressfinder</li>
            </ol>
        </div>
    </div>
    <div class="row" style="padding-top:3em">
        <div class="col-lg-2 col-md-2 col-md-offset-1 col-lg-offset-1">
            <form>
                <!--Cat-->
                <h4><b>CATEGORIEEN:</b></h4>
                <div style="margin-bottom:2em">
                    @foreach (Category c in ViewBag.CategoryID)
                    {
                        <a asp-controller="Dresses" asp-action="Overview"><div style="background:#fce8e7; margin-bottom:0.3em; padding:0.4em; padding-left:5%"><b>@c.Name</b></div></a>
                    }
                    <a asp-controller="Dresses" asp-action="Overview"><div style="background:#fce8e7; margin-bottom:0.3em; padding:0.4em; padding-left:5%"><b>Nieuwe Collectie</b></div></a>
                    <a asp-controller="Dresses" asp-action="Overview"><div style="background:#fce8e7; margin-bottom:0.3em; padding:0.4em; padding-left:5%"><b>Alle jurken bekijken</b></div></a>
                </div>

                <h5><b>Filter op:</b></h5>
                <!--Manu-->
                <a href="#manu" data-toggle="collapse" style="text-decoration:none" onclick="flipArrow('manua')">
                    <div class="element" onclick="changeColor(this)" style="background:#f6f6f6;">
                        <div style="display:flex">
                            <h4 style="flex-basis:90%; padding-left:5%">Merk</h4>
                            <p class="arrow" id="manua" style="transform:rotate(0deg); text-align:center">&#9650;</p>
                        </div>
                    </div>
                </a>
                <div id="manu" class="collapse in" style="background:#fcfcfc; margin:0.5em">
                    @foreach (Manu m in ViewBag.ManuID)
                    {
                        var id = "cManu" + m.ID;
                        try
                        {
                            if (ViewBag.Manucheck[m.ID] == 1)
                            { <input id="@id" type="checkbox" name="manu" value="@m.ID" class="css-checkbox" style="" checked />}
                        }
                        catch
                        {
                            <input id="@id" type="checkbox" name="manu" value="@m.ID" class="css-checkbox" style="" />
                        }
                        <label for="@id" class="css-label" style="font-weight:lighter; margin-bottom:0.8em">@m.Name</label>
                        <br />
                    }
                </div>

                <!--Style-->
                <a href="#style" data-toggle="collapse" style="text-decoration:none" onclick="flipArrow('stylea')">
                    <div class="element" onclick="changeColor(this)" style="background:#f6f6f6;">
                        <div style="display:flex">
                            <h4 style="flex-basis:90%; padding-left:5%">Stijl</h4>
                            <p class="arrow" id="stylea" style="transform:rotate(0deg); text-align:center">&#9650;</p>
                        </div>
                    </div>
                </a>
                <div id="style" class="collapse in" style="background:#fcfcfc; margin:0.5em">
                    @foreach (Style s in ViewBag.StyleID)
                    {
                        var id = "cStyle" + s.ID;
                        try
                        {
                            if (ViewBag.Stylecheck[s.ID] == 1)
                            {
                                <input id="@id" type="checkbox" name="style" value="@s.ID" class="css-checkbox" checked />

                            }

                        }
                        catch
                        {
                            <input id="@id" type="checkbox" name="style" value="@s.ID" class="css-checkbox" />

                        }
                        <label for="@id" style="font-weight:lighter; margin-bottom:0.8em" class="css-label">@s.Name</label>
                        <br />
                    }
                </div>

                <!--Price-->
                <input type="hidden" name="pricemin" id="pricemin" value="0" />
                <input type="hidden" name="pricemax" id="pricemax" value="15000" />
                <a href="#price" data-toggle="collapse" style="text-decoration:none" onclick="flipArrow('pricea')">
                    <div class="element" onclick="changeColor(this)" style="background:#f6f6f6;">
                        <div style="display:flex">
                            <h4 style="flex-basis:90%; padding-left:5%">Prijs</h4>
                            <p class="arrow" id="pricea" style="transform:rotate(0deg); text-align:center">&#9650;</p>
                        </div>
                    </div>
                </a>
                <div id="price" class="collapse in" style="background:#fcfcfc">
                    <input type="text" id="amount" readonly style="border:0; font-weight:bold; background:none">
                    <div id="slider-range" onclick="searchPrice()"></div>
                </div>

                <h5 style="margin-top:2em"><b>Filters verfijnen:</b></h5>
                <!--Neckline-->
                <a href="#neck" data-toggle="collapse" style="text-decoration:none" onclick="flipArrow('necka')">
                    <div class="element" onclick="changeColor(this)" style="background:white;">
                        <div style="display:flex">
                            <h4 style="flex-basis:90%; padding-left:5%">Neklijn</h4>
                            <p class="arrow" id="necka" style="transform:rotate(0deg); text-align:center">&#9660;</p>
                        </div>
                    </div>
                </a>
                <div id="neck" class="collapse" style="background:#fcfcfc; margin:0.5em">
                    @foreach (Neckline n in ViewBag.NecklineID)
                    {
                        var id = "cNeck" + n.ID;
                        try
                        {
                            if (ViewBag.Neckcheck[n.ID] == 1)
                            {
                                <input id="@id" type="checkbox" name="neckline" value="@n.ID" class="css-checkbox" checked />
                            }
                        }
                        catch
                        {
                            <input id="@id" type="checkbox" name="neckline" value="@n.ID" class="css-checkbox" />
                        }
                        <label for="@id" class="css-label" style="font-weight:lighter; margin-bottom:0.8em">@n.Name</label>
                        <br />
                    }
                </div>

                <!--Silhouette-->
                <a href="#sil" data-toggle="collapse" style="text-decoration:none" onclick="flipArrow('sila')">
                    <div class="element" onclick="changeColor(this)" style="background:white;">
                        <div style="display:flex">
                            <h4 style="flex-basis:90%; padding-left:5%">Silhouette</h4>
                            <p class="arrow" id="sila" style="transform:rotate(0deg); text-align:center">&#9660;</p>
                        </div>
                    </div>
                </a>
                <div id="sil" class="collapse" style="background:#fcfcfc; margin:0.5em">
                    @foreach (Silhouette s in ViewBag.SilhouetteID)
                    {
                        var id = "cSil" + s.ID;
                        try
                        {
                            if (ViewBag.Silcheck[s.ID] == 1)
                            {
                                <input id="@id" type="checkbox" name="silhouette" value="@s.ID" class="css-checkbox" checked />
                            }
                        }
                        catch
                        {
                            <input id="@id" type="checkbox" name="silhouette" value="@s.ID" class="css-checkbox" />
                        }
                        <label for="@id" style="font-weight:lighter; margin-bottom:0.8em" class="css-label">@s.Name</label>
                        <br />
                    }
                </div>

                <!--Color-->
                <a href="#color" data-toggle="collapse" style="text-decoration:none" onclick="flipArrow('colora')">
                    <div class="element" onclick="changeColor(this)" style="background:white;">
                        <div style="display:flex">
                            <h4 style="flex-basis:90%; padding-left:5%">Kleur</h4>
                            <p class="arrow" id="colora" style="transform:rotate(0deg); text-align:center">&#9660;</p>
                        </div>
                    </div>
                </a>
                <div id="color" class="collapse" style="background:#fcfcfc; margin:0.5em">
                    @foreach (Color c in ViewBag.ColorID)
                    {
                        var id = "cColor" + c.ID;
                        try
                        {
                            if (ViewBag.Colorcheck[c.ID] == 1)
                            {
                                <input id="@id" type="checkbox" name="color" value="@c.ID" class="css-checkbox" checked />
                            }
                        }
                        catch
                        {
                            <input id="@id" type="checkbox" name="color" value="@c.ID" class="css-checkbox" />
                        }
                        <label for="@id" class="css-label" style="font-weight:lighter; margin-bottom:0.8em">@c.Name</label>
                        <br />
                    }
                </div>
            </form>
        </div>
        <div class="col-md-8 col-lg-8">
            <div style="padding-bottom:3em">
                <label for="sort" style="display:inline;margin-left:60%">Sorteren op: </label>
                <select id="sort" onchange="sorting()" style="height:2.5em; width:15em">
                    <option value="hl">Prijs Hoog/ Laag</option>
                    <option value="lh">Prijs Laag/ Hoog</option>
                    <option value="a">Alfabetisch</option>
                </select>
            </div>
            <div id="overview" class="overview" style="width:100%; height:auto;">
            </div>
            <div style="display:flex; flex-direction:row; flex-wrap:wrap; margin-top:5em">
                <div style="flex:auto">
                    <label for="amnt" style="display:inline">Aantal tonen: </label>
                    <select id="amnt" onchange="amnt()" style="height:2.5em; width:6em">
                        <option value="24">24</option>
                        <option value="27">27</option>
                        <option value="30">30</option>
                        <option value="33">33</option>
                    </select>

                </div>
                <div style="flex:auto; text-align:right">
                    @{
                        int next = ViewBag.CurrentPage + 1;
                        int prev = ViewBag.CurrentPage - 1;
                    }
                    <nav aria-label="Page navigation">
                        <ul class="pagination">
                            <li>
                                <a onclick="goto(@prev)" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            @for (int i = 1; i <= ViewBag.Pages; i++)
                            {
                                <li>
                                    <a onclick="goto(@i)">@i</a>
                                </li>

                            }
                            <li>
                                <a onclick="goto(@next)" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
